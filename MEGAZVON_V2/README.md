# MEGAZVON_V2

#### created by : ss2s
<https://github.com/ss2s>

### MEGAZVON_V2  Arduino MEGA2560 программа для автоматического перезвона колоколов по заданному расписанию.

### поддерживает 24 колокола, у каждого колокола своя настройка. одновременно можно ударить до 8 колоколов.
### есть функция отбивания часов колоколом. есть меню с настройками.
### расписание поддерживает 70 разных мелодий(26 встроеных, 44 на флншке)
### в расписании учтены будни и выходные. есть возможность отметить день как праздничный кнопкой.
### мелодии можно записывать с планшета
### расписание можно изменять с планшета
### также мелодии и расписание можно редактировать на флешке

#### Arduino MEGA 2560
#### 24 РЕЛЕ
#### RTC DS3231
#### LCD KeyPad Shield 16/2
#### bluetooth
#### MicroSD

### ВАЖНАЯ ИНФОРМАЦИЯ:

#### ВСЕ НАСТРОЙКИ ВЫНЕСЕНЫ В ОТДЕЛЬНЫЙ ФАЙЛ "config24.h"
#### НАСТРОЙКА ДЛИТЕЛЬНОСТИ КАЖДОЙ НОТЫ В ФАЙЛЕ "config24.h"
#### НАСТРОЙКИ МЕЛОДИЙ В ФАЙЛЕ "melody24.h"
#### НАСТРОЙКИ РАСПИСАНИЯ В ФАЙЛЕ НА ФЛЕШКЕ (НАСТРОЙКИ ПО УМОЛЧАНИЮ В ФАЙЛЕ "config24.h")

#### все нужные файлы находятся в папке с прошивкой

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

## ФУНКЦИИ МЕНЮ:

#### функция удара в любой колокол с настраиваемыми параметрами.(сервисная функция для подбора конфигурации)++
#### настройка длительности для каждой ноты (не путать с задержкой между нотами)++
#### список всех мелодий, с возможностью прослушать выбранную мелодию.++
#### настройка часов, время и дата.++
#### настройка праздничных дней автоматически в час ночи (ручная праздника настройка с основного экрана кнопкой вверх).+
#### bluetooth приложение для андроид для проигрывания записи и воспроизведения мелодий

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

## ФУНКЦИИ ANDROID ПРИЛОЖЕНЯ:

#### ЭЛЕМЕНТЫ УПРАВЛЕНИЯ

#### ОСНОВНОЙ ДИСПЛЭЙ НАХОДИТСЯ СЛЕВА (ОДНОСТРОЧНЫЙ).
#### СПРАВА ЭТО НЕ ДИСПЛЕЙ ЭТО МОНИТОР ПОРТА.
#### лампочка индикатор в правом верхнем углу светится разным цветом в разных пунктах (индикатор не нажимается)
#### кнопка select меняет свое название в зависимости от действия которое она выполняет, в правом углу под индикатором
#### кнопки вверх вниз находятся слева вверху
#### цветные кнопки 3 ряда по 8 штук, при нажатии на них будет производится удар в колокол соответствующий номеру реле
#### цветные кнопки работают в режимах: PEREZVON, PRINT 1, PRINT 2, RECORD NEW MELODY.до 8 одновременно наж. кнопок

###  1 PERZVON      если в этом режиме нажать MEM (select) то перейдет в режим  - 1.1 PLAY MELODY FROM MEMORY
#### в режиме PEREZVON при нажатии цветных кнопок, буде производится удар в колокол соответствующий номеру реле
#### одновременно до 8 колоколов. по сути это режим рояль но играть нужно как на барабане(удар в колокол идет после отпускания кнопки)


###  1.1 PLAY MELODY FROM MEMORY       вызывается из режима PEREZVON если нажать кнопку MEM (select)
#### в этом режиме можно прослушать любую мелоди из энэргонезависимой памяти всего их 70. мелодия в оперативной памяти будет = выбранной
#### 44 на флэшке и могут быть записаны с режима REC 333 ноты в одной, ячейки в которых есть мелодия подсвечены знаком [>].
#### 26 в памяти программы записываются при прошивке 30 000 нот.
#### 70 это мелодия будничная если ее включить то она будет играть до когца часа(выключить раньше можно только кнопкой reset)


###  2 PRINT 1
#### этот режим аналогичен PEREZVON + вывод в сериал монитор текста в виде нот, которые записываются в память программы(30 000 нот на все)
#### применяется при создания мелодий для внутренней памяти(записываются при прошивке в файл melody.24)
#### нужно подключение к ПК по USB
#### после завершения печати нажать кнопку стоп для того чтоб напечаталась последняя закрывающая скобка


###  3 PRINT 2
#### этот режим аналогичен PEREZVON + вывод в сериал монитор текста в виде нот, которые записываются на флэшку(333 ноты в одной в одной)
#### применяется при создания отрезков для редактирования мелодий на флэшке
#### нужно подключение к ПК по USB
#### после завершения печати нажать кнопку стоп для того чтоб напечаталась последняя точка


###  4 RECORD NEW MELODY
#### в этом режиме можно записать новую мелодию в оперативную память. для начала записи нужно нажать кнопку REC индикатор станет желтым
#### если индикатор желтый значит идет запись, нажимайте цветные кнопки для проигрывания и одновременной записи мелодии.
#### после окончания записи нажмите кнопку STOP индикатор станет красным, мелодия записана в оперативную память.
#### все лишние задержки в начале и в конце записи удаляются автоматически.


###  PLAY NEW MELODY
#### в эттом режиме можно прослушать мелодию находящуюся в оперативной памяти. только что записаную или последнюю воспроизводимую
#### из энэргонезависимой памяти или последнюю мелодию перезвона.
#### тоесть если вы запишите новую мелодию в режиме REC то она будет воспроизводится в этом режиме.
#### нажмите PLAY


###  SAVE NEW MELODY
#### в этом режиме можно сохранить мелодию из оперативной памяти в энэргонезависимую память и выбрать ячейку для хранения 1-44.
#### ячейки в которых есть мелодия подсвечены знаком [>].
#### нажмиту select выберите ячейку нажмите SAVE


###  RASPISANIE
#### в этом режиме производится настройка расписания. нажмите select и выберите час 1-24 или минуты 15,30,45,
#### после выбора часа нажмите select и выберите мелодию из списка 1-70 для этого часа, после выбора мелодии нажмите select для сохранения


###  EXIT
#### выход. при нажати кнопки select в этом режиме, выключится реле питания блютуз и MEGAZVON перейдет в режим обработки расписания
#### для повторного включения блютуз функций, нужно нажать на мегазвоне(на котором реле) кнопку вниз.
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

## ПРАВИЛА РУЧНОГО НАПИСАНИЯ МЕЛОДИЙ ДЛЯ ПЕРЕЗВОНА ВО ВНУТРЕННЮЮ ПАМЯТЬ ДО 30 000 НОТ:

#### мелодии можно создавать при помощи специальных нот, MAX 24 ноты:
#### примеры нот:

## 1
#### enota(12, 250, 2000);  // это пример ноты расширеными параметрами
#### (номер колокола, время удара в колокол в мс, время до вызова следующей ноты в мс)

## 2
#### nota12(2000);  // это пример ноты с одним параметром. номер ноты задается в названии ноты
#### время удара в колокол в мс берется из файла "config24.h"
#### номер ноты в названии (время до вызова следующей ноты в мс)

## 3
#### nota(12, 2000);  // это пример ноты с двумя параметрами. номер ноты  и задержка до следующей ноты
#### время удара в колокол в мс берется из файла "config24.h"
#### nota(номер ноты, время до вызова следующей ноты в мс);

## 4
#### combo3(12, 14, 16, 2000);  // это пример комбо ноты. ударит одновременно в три колокола. максимальное комбо 8 нот.
#### в названии количество нот(1 колокол, 2 колокол, 3 колокол, время до вызова следующей ноты в мс)

## 5
#### с помощью Arduino, С/С++ синтаксиса. можно просто в функции мелодия управлять реле с помощю функций Arduino:
#### digitalWrite(номер пина к которому подключен пин, управляющий сигнал 0 или 1);
#### delay(задержка в мс);
#### можно комбинировать ноты и код Arduino.

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

## ПРИМЕР ТЕСТОВОЙ МЕЛОДИИ ИЗ ПАМЯТИ ПРОШИВКИ:

```
// мелодия EX1 пример мелодии с 1 набором нот
void melodiaEX1(){
	// здесь писать ноты
	enota(1, 95, 1000);    // 1 нота, реле 22 (время включения реле 95мс, задержка до следующей ноты 1000мс)
	enota(2, 105, 1000);   // 2 нота, реле 23 (время включения реле 105мс, задержка до следующей ноты 1000мс)
	enota(3, 100, 500);    // 3 нота, реле 24 (время включения реле 100мс, задержка до следующей ноты 500мс)
	enota(4, 100, 2000);   // 4 нота, реле 25 (время включения реле 100мс, задержка до следующей ноты 2000мс)
	enota(5, 100, 1000);   // 5 нота, реле 26 (время включения реле 100мс, задержка до следующей ноты 1000мс)
	enota(6, 100, 1000);   // 6 нота, реле 27 (время включения реле 100мс, задержка до следующей ноты 1000мс)
	enota(7, 100, 1000);   // 7 нота, реле 28 (время включения реле 100мс, задержка до следующей ноты 1000мс)
	enota(8, 100, 1000);   // 8 нота, реле 29 (время включения реле 100мс, задержка до следующей ноты 1000мс)
}

// мелодия EX2 пример мелодии со 2 набором нот
// для написания мелодий лучше использовать 2 или 3 набор нот. 1 для настройки колоколов и создания уникальных нот
void melodiaEX2(){
	// здесь писать ноты
	nota(1, 500);   // 1 нота, реле 22 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota(2, 500);   // 2 нота, реле 23 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota(3, 500);   // 3 нота, реле 24 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota(4, 500);   // 4 нота, реле 25 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota(5, 500);   // 5 нота, реле 26 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota(6, 500);   // 6 нота, реле 27 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota(7, 500);   // 7 нота, реле 28 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota(8, 500);   // 8 нота, реле 29 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)

	// пример комбо нот. удар в несколько колоколов одновременно
	combo2(1, 2, 500);   // комбо нота 2 колокола
	combo3(1, 2, 3, 500);   // комбо нота 3 колокола
	combo4(1, 2, 3, 4, 500);   // комбо нота 4 колокола
	combo5(1, 2, 3, 4, 5, 500);   // комбо нота 5 колоколов
	combo6(1, 2, 3, 4, 5, 6, 500);   // комбо нота 6 колоколов
	combo7(1, 2, 3, 4, 5, 6, 7, 500);   // комбо нота 7 колоколов
	combo8(1, 2, 3, 4, 5, 6, 7, 8, 500);   // комбо нота 8 колоколов
}

// мелодия EX3 пример мелодии с 3 набором нот
// для написания мелодий лучше использовать 2 или 3 набор нот. 1 для настройки колоколов и создания уникальных нот
void melodiaEX3(){
	// здесь писать ноты
	nota1(500);   // 1 нота, реле 22 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota2(500);   // 2 нота, реле 23 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota3(500);   // 3 нота, реле 24 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota4(500);   // 4 нота, реле 25 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota5(500);   // 5 нота, реле 26 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota6(500);   // 6 нота, реле 27 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota7(500);   // 7 нота, реле 28 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
	nota8(500);   // 8 нота, реле 29 (время включения реле задано в настройках нот, задержка до следующей ноты 500мс)
}
```

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
